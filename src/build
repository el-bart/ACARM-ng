#!/bin/bash

# use as much CPUs as possible
CPUS_DIST="`distcc -j`"
CPUS_LOCAL="`cat /proc/cpuinfo  | grep processor | wc -l`"

if grep -q "TC=intel" <<< "$@"
then
  exec make "-j$CPUS_LOCAL" "$@"
else
  exec make WITH_DISTCC=1 "-j$CPUS_DIST" "$@"
fi
